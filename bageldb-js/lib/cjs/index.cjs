(()=>{"use strict";var e={454:(e,t,n)=>{n.d(t,{CH:()=>a,ej:()=>c,NR:()=>l,od:()=>i(),Zb:()=>f,$R:()=>b});const r=require("axios");var i=n.n(r),o=n(752);const a=function(){function e(e){var t=e.instance,n=e.collectionID;Object.defineProperty(this,"instance",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"collectionID",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pageNumber",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"itemsPerPage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callEverything",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_query",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nestedCollectionsIDs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"axiosInstance",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiToken",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_projectOn",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_projectOff",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"requestID",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_item",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_field",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sortField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sortOrder",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.instance=t,this.collectionID=n,this._pageNumber=1,this.itemsPerPage=100,this.callEverything=!1,this._query=[],this.nestedCollectionsIDs=[],this.axiosInstance=i().create(),this.apiToken=t.apiToken,this._projectOn="",this._projectOff="",this.requestID="",this.sortField="",this.sortOrder="",this._item,this._field}return Object.defineProperty(e.prototype,"pageNumber",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this._pageNumber=e,this}}),Object.defineProperty(e.prototype,"perPage",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this.itemsPerPage=+e,this}}),Object.defineProperty(e.prototype,"everything",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this.callEverything=!0,this}}),Object.defineProperty(e.prototype,"collection",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this.nestedCollectionsIDs.push(e),this}}),Object.defineProperty(e.prototype,"item",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(!e)throw"item cant be "+e;if(this._item){if(this.nestedCollectionsIDs.length%2==0)throw"a nested item can only be placed after a nested collection";this.nestedCollectionsIDs.push(e)}else this._item=e;return this}}),Object.defineProperty(e.prototype,"query",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,n){if(!e)return this;Array.isArray(n)&&(n=n.join(","));var r=e+":"+t+":"+n;return this._query.push(encodeURIComponent(r)),this}}),Object.defineProperty(e.prototype,"sort",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return this.sortField=e,this.sortOrder=t||"",this}}),Object.defineProperty(e.prototype,"projectOn",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this._projectOn=e,this}}),Object.defineProperty(e.prototype,"projectOff",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this._projectOff=e,this}}),Object.defineProperty(e.prototype,"uploadImage",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r,i=this,o=t.selectedImage,a=t.imageLink,c=t.altText,s=t.fileName,u=new Function("try {return this===global;}catch(e){return false;}");if(u()){var l=n(941);r=new l}else r=new FormData;var b,h=this.nestedCollectionsIDs.join(".");return c&&r.append("altText",c),a?r.append("imageLink",a):r.append("imageFile",o,s),u()&&(b=r.getHeaders()),new Promise((function(t,n){var o="".concat(f,"/collection/").concat(i.collectionID,"/items/").concat(i._item,"/image?imageSlug=").concat(e,"&nestedID=").concat(h);i.instance.axiosInstance.put(o,r,{headers:b}).then((function(e){t(e)})).catch((function(e){return n(e)}))}))}}),Object.defineProperty(e.prototype,"delete",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this,t=this.nestedCollectionsIDs.join("."),n="".concat(f,"/collection/").concat(this.collectionID,"/items/").concat(this._item);return t&&(n+="?nestedID=".concat(t)),new Promise((function(t,r){e.instance.axiosInstance.delete(n).then((function(e){return t(e)})).catch((function(e){return r(e)}))}))}}),Object.defineProperty(e.prototype,"set",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this,n=this.nestedCollectionsIDs.join("."),r="".concat(f,"/collection/").concat(this.collectionID,"/items/").concat(this._item,"?set=true");return n&&(r+="&nestedID=".concat(n)),new Promise((function(n,i){t.instance.axiosInstance.put(r,JSON.stringify(e)).then((function(e){return(0,o.__awaiter)(t,void 0,void 0,(function(){return(0,o.__generator)(this,(function(t){return n(e),[2]}))}))})).catch((function(e){return i(e)}))}))}}),Object.defineProperty(e.prototype,"put",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this,n=this.nestedCollectionsIDs.join("."),r="".concat(f,"/collection/").concat(this.collectionID,"/items/").concat(this._item);return n&&(r+="?nestedID=".concat(n)),new Promise((function(n,i){t.instance.axiosInstance.put(r,JSON.stringify(e)).then((function(e){return(0,o.__awaiter)(t,void 0,void 0,(function(){return(0,o.__generator)(this,(function(t){return n(e),[2]}))}))})).catch((function(e){return i(e)}))}))}}),Object.defineProperty(e.prototype,"post",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this,n=this.nestedCollectionsIDs.join(".");return new Promise((function(r,i){var o="".concat(f,"/collection/").concat(t.collectionID,"/items");n&&(o+="/".concat(t._item,"?nestedID=").concat(n)),t.instance.axiosInstance.post(o,e).then((function(e){r(e)})).catch((function(e){i(e)}))}))}}),Object.defineProperty(e.prototype,"append",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var n=this,r=this.nestedCollectionsIDs.join(".");return new Promise((function(i,o){var a="".concat(f,"/collection/").concat(n.collectionID,"/items/").concat(n._item,"/field/").concat(e);r&&(a+="?nestedID=".concat(r)),n.instance.axiosInstance.put(a,{value:t}).then((function(e){i(e)})).catch((function(e){o(e)}))}))}}),Object.defineProperty(e.prototype,"field",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(!e||e.match(/\s/))throw"field slug cant be "+e;return this._field=e,this}}),Object.defineProperty(e.prototype,"increment",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this;if(!this._field)throw"field must be set to use the increment method";if(isNaN(parseFloat(e)))throw"Increment value must be a number";var n=this.nestedCollectionsIDs.join(".");return new Promise((function(r,i){var o="".concat(f,"/collection/").concat(t.collectionID,"/items/").concat(t._item,"/field/").concat(t._field,"?increment=").concat(e);n&&(o+="&nestedID=".concat(n)),t.instance.axiosInstance.put(o).then((function(e){r(e)})).catch((function(e){i(e)}))}))}}),Object.defineProperty(e.prototype,"decrement",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this;if(!this._field)throw"field must be set to use the decrement method";if("string"==typeof e&&(e=parseFloat(e)),isNaN(e))throw"Increment value must be a number";e>0&&(e*=-1);var n=this.nestedCollectionsIDs.join(".");return new Promise((function(r,i){var o="".concat(f,"/collection/").concat(t.collectionID,"/items/").concat(t._item,"/field/").concat(t._field,"?increment=").concat(e);n&&(o+="&nestedID=".concat(n)),t.instance.axiosInstance.put(o).then((function(e){r(e)})).catch((function(e){i(e)}))}))}}),Object.defineProperty(e.prototype,"unset",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var n=this,r=this.nestedCollectionsIDs.join(".");if(r)throw"Unset is not yet supported in nested collections";return new Promise((function(i,o){var a="".concat(f,"/collection/").concat(n.collectionID,"/items/").concat(n._item,"/field/").concat(e);r&&(a+="?nestedID=".concat(r)),n.instance.axiosInstance.delete(a,{data:{value:t}}).then((function(e){i(e)})).catch((function(e){o(e)}))}))}}),Object.defineProperty(e.prototype,"value",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var n=this,r=this.nestedCollectionsIDs.join(".");return new Promise((function(i,o){var a="".concat(f,"/collection/").concat(n.collectionID,"/items/").concat(n._item,"/field/").concat(e);r&&(a+="?nestedID=".concat(r)),n.instance.axiosInstance.delete(a,{data:{value:t}}).then((function(e){i(e)})).catch((function(e){o(e)}))}))}}),Object.defineProperty(e.prototype,"get",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;return new Promise((function(t,n){var r=new URLSearchParams,i=e.nestedCollectionsIDs.join(".");e._pageNumber&&r.append("pageNumber",String(e._pageNumber)),e.sortField&&r.append("sort",e.sortField),e.sortOrder&&r.append("order",e.sortOrder),e.itemsPerPage&&r.append("perPage",String(e.itemsPerPage)),e.callEverything&&r.append("everything",String(e.callEverything)),""!=e._projectOff&&r.append("projectOff",e._projectOff),""!=e._projectOn&&r.append("projectOn",e._projectOn);var o=e._item?"/"+e._item:"",a="".concat(f,"/collection/").concat(e.collectionID,"/items").concat(o,"?").concat(r.toString());e._query.length>0&&(a=a+"&query="+e._query.join("%2B")),i&&(a+="&nestedID=".concat(i)),e.instance.axiosInstance.get(a).then((function(e){e.status>=200&&e.status<400?t(e):n(e)})).catch((function(e){n(e)}))}))}}),Object.defineProperty(e.prototype,"users",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;if(!this._item)throw new Error("Users can only be retrieved in relation to an item");var t=this.nestedCollectionsIDs.join(".");return new Promise((function(n,r){var i="".concat(f,"/collection/").concat(e.collectionID,"/items/").concat(e._item,"/bagelUsers");t&&(i+="?nestedID=".concat(t)),e.instance.axiosInstance.get(i).then((function(e){n(e)})).catch((function(e){r(e)}))}))}}),Object.defineProperty(e.prototype,"addUser",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this;if(!this._item)throw new Error("Users can only be added in relation to an item");var n=this.nestedCollectionsIDs.join(".");return new Promise((function(r,i){var o="".concat(f,"/collection/").concat(t.collectionID,"/items/").concat(t._item,"/bagelUsers");n&&(o+="?nestedID=".concat(n)),t.instance.axiosInstance.put(o,{userID:e}).then((function(e){r(e)})).catch((function(e){i(e)}))}))}}),Object.defineProperty(e.prototype,"removeUser",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this;if(!this._item)throw new Error("Users can only be removed in relation to an item");var n=this.nestedCollectionsIDs.join(".");return new Promise((function(r,i){var o="".concat(f,"/collection/").concat(t.collectionID,"/items/").concat(t._item,"/bagelUsers");n&&(o+="?nestedID=".concat(n)),t.instance.axiosInstance.delete(o,{data:{userID:e}}).then((function(e){r(e)})).catch((function(e){i(e)}))}))}}),Object.defineProperty(e.prototype,"listen",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return(0,o.__awaiter)(this,void 0,void 0,(function(){var n,r,i,a,c,s=this;return(0,o.__generator)(this,(function(u){switch(u.label){case 0:if(!e)throw new Error("onMessage callback must be defined");return[4,this.instance.users()._bagelUserActive()];case 1:return u.sent()?[4,this.instance.users()._getAccessToken()]:[3,3];case 2:return n=u.sent(),[3,4];case 3:n=this.apiToken,u.label=4;case 4:return r=this.nestedCollectionsIDs.join("."),i=b+"/collection/".concat(this.collectionID,"/live?authorization=").concat(n,"&nestedID=").concat(r,"&itemID=").concat(this._item),this.client=new EventSource(i),a=this,c=function(e){return(0,o.__awaiter)(s,void 0,void 0,(function(){var i;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return a.client.readyState!==EventSource.CLOSED?[3,4]:[4,a.instance.users()._bagelUserActive()];case 1:return o.sent()?[4,a.instance.users().refresh()]:[3,4];case 2:return o.sent(),[4,a.instance.users()._getAccessToken()];case 3:return n=o.sent(),i=b+"/collection/".concat(a.collectionID,"/live?authorization=").concat(n,"&requestID=").concat(a.requestID,"&nestedID=").concat(r,"&itemID=").concat(a._item),a.client=new EventSource(i),[2];case 4:return t&&t(e),[2]}}))}))},this.client.addEventListener("start",(function(e){a.requestID=e.data})),this.client.addEventListener("stop",(function(){return(0,o.__awaiter)(s,void 0,void 0,(function(){var t;return(0,o.__generator)(this,(function(i){switch(i.label){case 0:return[4,a.instance.users()._bagelUserActive()];case 1:return i.sent()?[4,a.instance.users()._getAccessToken()]:[3,3];case 2:return n=i.sent(),[3,4];case 3:n=a.apiToken,i.label=4;case 4:return a.client.close(),t=b+"/collection/".concat(a.collectionID,"/live?authorization=").concat(n,"&requestID=").concat(a.requestID,"&nestedID=").concat(r,"&itemID=").concat(a._item),a.client=new EventSource(t),a.client.onmessage=e,a.client.onerror=c,[2]}}))}))})),this.client.onmessage=e,this.client.onerror=c,[2,this.client]}}))}))}}),e}(),c=function(e){function t(t){var n=t.instance,r=t.collectionID;return e.call(this,{instance:n,collectionID:r})||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"get",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;return new Promise((function(t,n){var r="".concat(f,"/collection/").concat(e.collectionID,"/schema");e.instance.axiosInstance.get(r).then((function(e){e.status>=200&&e.status<400?t(e):n(e)})).catch((function(e){n(e)}))}))}}),t}(a),s=require("lodash-es");var u="https://auth.bageldb.com/api/public";(null===globalThis||void 0===globalThis?void 0:globalThis.localStorage)||(globalThis.localStorage=new function(e){Object.defineProperty(this,"key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"getItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"removeItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clear",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"length",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__protected",{enumerable:!0,configurable:!0,writable:!0,value:void 0});var t=this;e||(e={});var n=(0,s.keys)(e),r=function(e){return(0,s.isUndefined)(e)?null:e};this.key=function(e){var t=n[e];return r(t)},this.setItem=function(r,i){(0,s.includes)(n,r)||n.push(r),e[r]=i,t.length=(0,s.size)(e)},this.getItem=function(t){var n=e[t];return r(n)},this.removeItem=function(r){delete e[r],n=(0,s.without)(n,r),t.length=(0,s.size)(e)},this.clear=function(){var t=(0,s.keys)(e),n=this.removeItem;t.forEach((function(e){n(e)}))},this.length=(0,s.size)(e),this.__protected=function(){return{data:e}}}({}));const l=function(){function e(e){var t,n=e.instance;Object.defineProperty(this,"instance",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"axios",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bagelStorage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.instance=n,this.axios=this.instance.axiosInstance,this.bagelStorage=(null===(t=this.instance)||void 0===t?void 0:t.customStorage)||(null===globalThis||void 0===globalThis?void 0:globalThis.localStorage)}return Object.defineProperty(e.prototype,"_isBrowser",{enumerable:!1,configurable:!0,writable:!0,value:function(){return!new Function("try {return this===global;}catch(e){return false;}")()}}),Object.defineProperty(e.prototype,"_bagelUserActive",{enumerable:!1,configurable:!0,writable:!0,value:function(){return(0,o.__awaiter)(this,void 0,void 0,(function(){var e,t;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return e=this._isBrowser(),[4,this.getBagelUserID()];case 1:return t=n.sent(),[2,e&&null!==t&&t.length>0]}}))}))}}),Object.defineProperty(e.prototype,"create",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var n=this;return e=e.toLowerCase().trim(),new Promise((function(r,i){var o="".concat(u,"/user"),a={email:e,password:t};n.axios.post(o,a).then((function(e){if(201==e.status){var t=e.data;if(n.instance.isServer)return void r(t.user_id);n._storeTokens(t),n._storeBagelUser(t.user_id),r(t.user_id)}else i(e)})).catch((function(e){i(e)}))}))}}),Object.defineProperty(e.prototype,"validateOtp",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,o.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return[4,this._getOtpRequestNonce()];case 1:t=o.sent(),n="".concat(u,"/user/otp/verify/").concat(t),r={otp:e},o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this.axios.post(n,r)];case 3:return i=o.sent(),this._storeTokens(i.data),[2,i.data.user_id];case 4:throw o.sent(),"wrong authorization code";case 5:return[2]}}))}))}}),Object.defineProperty(e.prototype,"_getOtpRequestNonce",{enumerable:!1,configurable:!0,writable:!0,value:function(){return(0,o.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.bagelStorage.getItem("bagel-nonce")];case 1:return e=r.sent(),[4,this.bagelStorage.getItem("bagel-expires")];case 2:if(t=+(r.sent()||""),e&&t){if(n=new Date,t<=n.setSeconds(n.getSeconds()))throw"OTP request has expired, try again";return[2,e]}throw"Request an OTP first"}}))}))}}),Object.defineProperty(e.prototype,"requestOtp",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,o.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return(0,o.__generator)(this,(function(i){switch(i.label){case 0:e=e.toLowerCase().trim(),t="".concat(u,"/user/otp"),n={emailOrPhone:e},i.label=1;case 1:return i.trys.push([1,4,,5]),[4,this.axios.post(t,n)];case 2:return r=i.sent(),[4,this._storeOtpRequestNonce(r.data)];case 3:return i.sent(),[2,r.data.nonce];case 4:return[2,i.sent()];case 5:return[2]}}))}))}}),Object.defineProperty(e.prototype,"_storeOtpRequestNonce",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=e.nonce,n=e.expires_in;return(0,o.__awaiter)(this,void 0,void 0,(function(){var e,r;return(0,o.__generator)(this,(function(i){switch(i.label){case 0:return e=new Date,r="".concat(e.setSeconds(e.getSeconds()+n)),[4,this.bagelStorage.setItem("bagel-nonce",t)];case 1:return i.sent(),[4,this.bagelStorage.setItem("bagel-expires",r)];case 2:return i.sent(),[2]}}))}))}}),Object.defineProperty(e.prototype,"validate",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var n=this;return e=e.toLowerCase().trim(),new Promise((function(r,i){var o="".concat(u,"/user/verify"),a={email:e,password:t};n.axios.post(o,a).then((function(e){if(200==e.status){var t=e.data;n._storeTokens(t),n._storeBagelUser(t.user_id),r(t.user_id)}else i(e)})).catch((function(e){i(e)}))}))}}),Object.defineProperty(e.prototype,"getUser",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;return new Promise((function(t,n){if(e._bagelUserActive()){var r="".concat(u,"/user");e.axios.get(r).then((function(e){200==e.status?t(e):n(e)})).catch((function(e){n(e)}))}else n(new Error("a Bagel User must be logged in to get Bagel User info"+e._bagelUserActive()))}))}}),Object.defineProperty(e.prototype,"requestPasswordReset",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this;return e=e.toLowerCase().trim(),new Promise((function(n,r){var i="".concat(u,"/user/resetpassword"),o={email:e};t.axios.post(i,o).then((function(e){200==e.status?n(e):r(e)})).catch((function(e){r(e)}))}))}}),Object.defineProperty(e.prototype,"updatePassword",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var n=this;return e=e.toLowerCase().trim(),new Promise((function(r,i){if(n._isBrowser())i(new Error("Update Password feature is only available when using NodeJS"));else{var o="".concat(u,"/user/updatePassword"),a={email:e,password:t};n.axios.post(o,a).then((function(e){200==e.status?r(e):i(e)})).catch((function(e){i(e)}))}}))}}),Object.defineProperty(e.prototype,"_storeBagelUser",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,o.__awaiter)(this,void 0,void 0,(function(){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.bagelStorage.setItem("bagel-user",e)];case 1:return t.sent(),[2]}}))}))}}),Object.defineProperty(e.prototype,"_storeTokens",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,o.__awaiter)(this,void 0,void 0,(function(){var t;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.bagelStorage.setItem("bagel-access",e.access_token)];case 1:return n.sent(),(t=new Date).setSeconds(t.getSeconds()+e.expires_in),[4,this.bagelStorage.setItem("bagel-expires",t)];case 2:return n.sent(),[4,this.bagelStorage.setItem("bagel-refresh",e.refresh_token)];case 3:return n.sent(),[2]}}))}))}}),Object.defineProperty(e.prototype,"getBagelUserID",{enumerable:!1,configurable:!0,writable:!0,value:function(){return(0,o.__awaiter)(this,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.bagelStorage.getItem("bagel-user")];case 1:return[2,e.sent()]}}))}))}}),Object.defineProperty(e.prototype,"_getRefreshToken",{enumerable:!1,configurable:!0,writable:!0,value:function(){return(0,o.__awaiter)(this,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.bagelStorage.getItem("bagel-refresh")];case 1:return[2,e.sent()]}}))}))}}),Object.defineProperty(e.prototype,"_getAccessToken",{enumerable:!1,configurable:!0,writable:!0,value:function(){return(0,o.__awaiter)(this,void 0,void 0,(function(){var e;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.bagelStorage.getItem("bagel-expires")];case 1:return e=t.sent()||"",new Date(e)<=new Date?[2,this.refresh()]:[3,2];case 2:return[4,this.bagelStorage.getItem("bagel-access")];case 3:return[2,t.sent()]}}))}))}}),Object.defineProperty(e.prototype,"logout",{enumerable:!1,configurable:!0,writable:!0,value:function(){return(0,o.__awaiter)(this,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.bagelStorage.removeItem("bagel-user")];case 1:return e.sent(),[4,this.bagelStorage.removeItem("bagel-access")];case 2:return e.sent(),[4,this.bagelStorage.removeItem("bagel-refresh")];case 3:return e.sent(),[2]}}))}))}}),Object.defineProperty(e.prototype,"refresh",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;return new Promise((function(t,n){if(e._getRefreshToken()){var r="".concat(u,"/user/token"),i="grant_type=refresh_token&refresh_token=".concat(e._getRefreshToken(),"&client_id=project-client");e.axios.post(r,i).then((function(r){if(200===r.status){var i=r.data;e._storeTokens(i),t(i.access_token)}else n(r)})).catch((function(e){n(e)}))}else n(new Error("No Bagel User is logged in"))}))}}),e}();var f="https://api.bagelstudio.co/api/public",b="https://live.bageldb.com/api/public"},941:e=>{e.exports=require("form-data")},752:e=>{e.exports=require("tslib")}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r={};(()=>{n.d(r,{default:()=>i});var e=n(752),t=n(454);const i=function(){function n(n,r){void 0===r&&(r={isServer:!1,customStorage:void 0});var i=this;Object.defineProperty(this,"isServer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"customStorage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiToken",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"axiosInstance",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.isServer=!!r.isServer,this.customStorage=r.customStorage,this.apiToken=n,this.axiosInstance=t.od.create(),this.axiosInstance.interceptors.request.use((function(r){return(0,e.__awaiter)(i,void 0,void 0,(function(){var i,o;return(0,e.__generator)(this,(function(e){switch(e.label){case 0:return r.headers["Accept-Version"]="v1",[4,new t.NR({instance:this})._bagelUserActive()];case 1:return e.sent()&&!(null===(o=r.url)||void 0===o?void 0:o.includes("user/token"))?(i=new t.NR({instance:this})._getAccessToken(),r.headers.Authorization="Bearer "+i):r.headers.Authorization="Bearer "+n,[2,r]}}))}))}),(function(e){return Promise.reject(e)})),this.axiosInstance.interceptors.response.use((function(e){return e}),(function(n){return(0,e.__awaiter)(i,void 0,void 0,(function(){var r=this;return(0,e.__generator)(this,(function(e){switch(e.label){case 0:return[4,new t.NR({instance:this})._bagelUserActive()];case 1:return e.sent()&&n.response&&401==n.response.status&&!n.config.url.includes("user/token")?[2,new t.NR({instance:this}).refresh().then((function(){var e=n.config;return e.headers.Authorization="Bearer ".concat(new t.NR({instance:r})._getAccessToken()),new Promise((function(n,r){t.od.request(e).then((function(e){n(e)})).catch((function(e){r(e)}))}))})).catch((function(){return Promise.reject(n)}))]:[2,Promise.reject(n)]}}))}))}))}return Object.defineProperty(n.prototype,"schema",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return new t.ej({instance:this,collectionID:e})}}),Object.defineProperty(n.prototype,"collection",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return new t.CH({instance:this,collectionID:e})}}),Object.defineProperty(n.prototype,"users",{enumerable:!1,configurable:!0,writable:!0,value:function(){return new t.NR({instance:this})}}),Object.defineProperty(n,"ASC",{get:function(){return"ASC"},enumerable:!1,configurable:!0}),Object.defineProperty(n,"DESC",{get:function(){return"DESC"},enumerable:!1,configurable:!0}),Object.defineProperty(n,"EQUAL",{get:function(){return"="},enumerable:!1,configurable:!0}),Object.defineProperty(n,"NOT_EQUAL",{get:function(){return"!="},enumerable:!1,configurable:!0}),Object.defineProperty(n,"GREATER_THAN",{get:function(){return">"},enumerable:!1,configurable:!0}),Object.defineProperty(n,"LESS_THAN",{get:function(){return"<"},enumerable:!1,configurable:!0}),Object.defineProperty(n,"WITHIN",{get:function(){return"within"},enumerable:!1,configurable:!0}),Object.defineProperty(n,"GeoPointQuery",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,n){return"".concat(e,",").concat(t,",").concat(n)}}),n}()})(),exports.default=r.default.default,Object.defineProperty(exports,"__esModule",{value:!0})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFJQyxNQUU1QixFQWpIQSxJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQGJhZ2VsZGIvYmFnZWwtZGIvZXh0ZXJuYWwgY29tbW9uanMgXCJheGlvc1wiIiwid2VicGFjazovL0BiYWdlbGRiL2JhZ2VsLWRiLy4vc3JjL2JhZ2VsREJSZXF1ZXN0LnRzIiwid2VicGFjazovL0BiYWdlbGRiL2JhZ2VsLWRiLy4vc3JjL2JhZ2VsTWV0YVJlcXVlc3QudHMiLCJ3ZWJwYWNrOi8vQGJhZ2VsZGIvYmFnZWwtZGIvZXh0ZXJuYWwgY29tbW9uanMgXCJsb2Rhc2gtZXNcIiIsIndlYnBhY2s6Ly9AYmFnZWxkYi9iYWdlbC1kYi8uL3NyYy91c2Vycy50cyIsIndlYnBhY2s6Ly9AYmFnZWxkYi9iYWdlbC1kYi8uL3NyYy9mYlN0b3JhZ2UudHMiLCJ3ZWJwYWNrOi8vQGJhZ2VsZGIvYmFnZWwtZGIvLi9zcmMvY29tbW9uLnRzIiwid2VicGFjazovL0BiYWdlbGRiL2JhZ2VsLWRiL2V4dGVybmFsIGNvbW1vbmpzIFwiZm9ybS1kYXRhXCIiLCJ3ZWJwYWNrOi8vQGJhZ2VsZGIvYmFnZWwtZGIvZXh0ZXJuYWwgY29tbW9uanMgXCJ0c2xpYlwiIiwid2VicGFjazovL0BiYWdlbGRiL2JhZ2VsLWRiL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0BiYWdlbGRiL2JhZ2VsLWRiL3dlYnBhY2svcnVudGltZS9jb21wYXQgZ2V0IGRlZmF1bHQgZXhwb3J0Iiwid2VicGFjazovL0BiYWdlbGRiL2JhZ2VsLWRiL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9AYmFnZWxkYi9iYWdlbC1kYi93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL0BiYWdlbGRiL2JhZ2VsLWRiLy4vc3JjL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IF9fV0VCUEFDS19OQU1FU1BBQ0VfT0JKRUNUX18gPSByZXF1aXJlKFwiYXhpb3NcIik7IiwiaW1wb3J0IHsgQXhpb3NJbnN0YW5jZSwgQXhpb3NQcm9taXNlLCBBeGlvc1Jlc3BvbnNlIH0gZnJvbSBcImF4aW9zXCI7XG5pbXBvcnQgeyBheGlvcyB9IGZyb20gXCIuL2NvbW1vblwiO1xuaW1wb3J0IHsgYmFzZUVuZHBvaW50LCBsaXZlRW5kcG9pbnQgfSBmcm9tIFwiLi9jb21tb25cIjtcbmltcG9ydCB7IGJhZ2VsVHlwZSwgZmlsZVVwbG9hZEFyZ3MsIHN0cnVjdEFyZ3MgfSBmcm9tIFwiLi9pbnRlcmZhY2VzXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCYWdlbERCUmVxdWVzdCB7XG4gIGluc3RhbmNlOiBiYWdlbFR5cGU7XG4gIGNvbGxlY3Rpb25JRDogc3RyaW5nO1xuICBfcGFnZU51bWJlcjogbnVtYmVyO1xuICBpdGVtc1BlclBhZ2U6IG51bWJlcjtcbiAgY2FsbEV2ZXJ5dGhpbmc6IGJvb2xlYW47XG4gIF9xdWVyeTogYW55W107XG4gIG5lc3RlZENvbGxlY3Rpb25zSURzOiBhbnlbXTtcbiAgYXhpb3NJbnN0YW5jZTogQXhpb3NJbnN0YW5jZTtcbiAgYXBpVG9rZW46IHN0cmluZztcbiAgX3Byb2plY3RPbjogc3RyaW5nO1xuICBfcHJvamVjdE9mZjogc3RyaW5nO1xuICByZXF1ZXN0SUQ6IHN0cmluZztcbiAgY2xpZW50ITogRXZlbnRTb3VyY2U7XG4gIF9pdGVtOiBhbnk7XG4gIF9maWVsZDogYW55O1xuICBzb3J0RmllbGQ6IHN0cmluZztcbiAgc29ydE9yZGVyOiBzdHJpbmc7XG4gIFt4OiBzdHJpbmddOiBhbnk7XG5cbiAgY29uc3RydWN0b3IoeyBpbnN0YW5jZSwgY29sbGVjdGlvbklEIH06IHN0cnVjdEFyZ3MpIHtcbiAgICB0aGlzLmluc3RhbmNlID0gaW5zdGFuY2U7XG4gICAgdGhpcy5jb2xsZWN0aW9uSUQgPSBjb2xsZWN0aW9uSUQ7XG4gICAgdGhpcy5fcGFnZU51bWJlciA9IDE7XG4gICAgdGhpcy5pdGVtc1BlclBhZ2UgPSAxMDA7XG4gICAgdGhpcy5jYWxsRXZlcnl0aGluZyA9IGZhbHNlO1xuICAgIHRoaXMuX3F1ZXJ5ID0gW107XG4gICAgdGhpcy5uZXN0ZWRDb2xsZWN0aW9uc0lEcyA9IFtdO1xuICAgIHRoaXMuYXhpb3NJbnN0YW5jZSA9IGF4aW9zLmNyZWF0ZSgpO1xuICAgIHRoaXMuYXBpVG9rZW4gPSBpbnN0YW5jZS5hcGlUb2tlbjtcbiAgICB0aGlzLl9wcm9qZWN0T24gPSBcIlwiO1xuICAgIHRoaXMuX3Byb2plY3RPZmYgPSBcIlwiO1xuICAgIHRoaXMucmVxdWVzdElEID0gXCJcIjtcbiAgICB0aGlzLnNvcnRGaWVsZCA9IFwiXCI7XG4gICAgdGhpcy5zb3J0T3JkZXIgPSBcIlwiO1xuICAgIC8vIHRoaXMuY2xpZW50O1xuICAgIHRoaXMuX2l0ZW07XG4gICAgdGhpcy5fZmllbGQ7XG4gIH1cbiAgLy8gUGFnaW5hdGlvblxuICBwYWdlTnVtYmVyKHBhZ2VOdW1iZXIpIHtcbiAgICB0aGlzLl9wYWdlTnVtYmVyID0gcGFnZU51bWJlcjtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHBlclBhZ2UocGVyUGFnZTogbnVtYmVyIHwgc3RyaW5nKSB7XG4gICAgdGhpcy5pdGVtc1BlclBhZ2UgPSArcGVyUGFnZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGV2ZXJ5dGhpbmcoKSB7XG4gICAgdGhpcy5jYWxsRXZlcnl0aGluZyA9IHRydWU7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBjb2xsZWN0aW9uKGNvbGxlY3Rpb25TbHVnKSB7XG4gICAgdGhpcy5uZXN0ZWRDb2xsZWN0aW9uc0lEcy5wdXNoKGNvbGxlY3Rpb25TbHVnKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGl0ZW0oX2lkKSB7XG4gICAgaWYgKCFfaWQpIHRocm93IFwiaXRlbSBjYW50IGJlIFwiICsgX2lkO1xuICAgIGlmICh0aGlzLl9pdGVtKSB7XG4gICAgICBpZiAodGhpcy5uZXN0ZWRDb2xsZWN0aW9uc0lEcy5sZW5ndGggJSAyID09PSAwKVxuICAgICAgICB0aHJvdyBcImEgbmVzdGVkIGl0ZW0gY2FuIG9ubHkgYmUgcGxhY2VkIGFmdGVyIGEgbmVzdGVkIGNvbGxlY3Rpb25cIjtcbiAgICAgIHRoaXMubmVzdGVkQ29sbGVjdGlvbnNJRHMucHVzaChfaWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9pdGVtID0gX2lkO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHF1ZXJ5KGtleSwgb3BlcmF0b3IsIHZhbHVlKSB7XG4gICAgaWYgKCFrZXkpIHJldHVybiB0aGlzO1xuICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkgdmFsdWUgPSB2YWx1ZS5qb2luKFwiLFwiKTtcbiAgICBjb25zdCBxdWVyeSA9IGtleSArIFwiOlwiICsgb3BlcmF0b3IgKyBcIjpcIiArIHZhbHVlO1xuICAgIHRoaXMuX3F1ZXJ5LnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXJ5KSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBzb3J0KGZpZWxkLCBvcmRlcikge1xuICAgIHRoaXMuc29ydEZpZWxkID0gZmllbGQ7XG4gICAgdGhpcy5zb3J0T3JkZXIgPSBvcmRlciB8fCBcIlwiO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgcHJvamVjdE9uKHNsdWdzKSB7XG4gICAgdGhpcy5fcHJvamVjdE9uID0gc2x1Z3M7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBwcm9qZWN0T2ZmKHNsdWdzKSB7XG4gICAgdGhpcy5fcHJvamVjdE9mZiA9IHNsdWdzO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLy8gRWl0aGVyIG9mIGltYWdlTGluayBvciBzZWxlY3RlZEltYWdlIG11c3QgYmUgdXNlZFxuICAvLyBzZWxlY3RlZEltYWdlIGV4cGVjdHMgYSBmaWxlIHN0cmVhbSBpLmUgZnMuY3JlYXRlUmVhZFN0cmVhbShmaWxlbmFtZSlcbiAgdXBsb2FkSW1hZ2UoaW1hZ2VTbHVnOiBzdHJpbmcsIHsgc2VsZWN0ZWRJbWFnZSwgaW1hZ2VMaW5rLCBhbHRUZXh0LCBmaWxlTmFtZSB9OiBmaWxlVXBsb2FkQXJncyk6IEF4aW9zUHJvbWlzZSB7XG4gICAgY29uc3QgaXNOb2RlID0gbmV3IEZ1bmN0aW9uKFwidHJ5IHtyZXR1cm4gdGhpcz09PWdsb2JhbDt9Y2F0Y2goZSl7cmV0dXJuIGZhbHNlO31cIik7XG4gICAgbGV0IGZvcm07XG4gICAgaWYgKGlzTm9kZSgpKSB7XG4gICAgICBjb25zdCBGb3JtRGF0YSA9IHJlcXVpcmUoJ2Zvcm0tZGF0YScpO1xuXHRcdFx0Zm9ybSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3JtID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgfVxuICAgIGNvbnN0IG5lc3RlZElEID0gdGhpcy5uZXN0ZWRDb2xsZWN0aW9uc0lEcy5qb2luKFwiLlwiKTtcbiAgICBpZiAoYWx0VGV4dCkge1xuICAgICAgZm9ybS5hcHBlbmQoXCJhbHRUZXh0XCIsIGFsdFRleHQpO1xuICAgIH1cbiAgICBpZiAoaW1hZ2VMaW5rKSB7XG4gICAgICBmb3JtLmFwcGVuZChcImltYWdlTGlua1wiLCBpbWFnZUxpbmspO1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3JtLmFwcGVuZChcImltYWdlRmlsZVwiLCBzZWxlY3RlZEltYWdlLCBmaWxlTmFtZSk7XG4gICAgfVxuICAgIGxldCBmb3JtSGVhZGVycztcbiAgICBpZiAoaXNOb2RlKCkpIHtcbiAgICAgIGZvcm1IZWFkZXJzID0gZm9ybS5nZXRIZWFkZXJzKCk7XG4gICAgfVxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBjb25zdCB1cmwgPSBgJHtiYXNlRW5kcG9pbnR9L2NvbGxlY3Rpb24vJHt0aGlzLmNvbGxlY3Rpb25JRH0vaXRlbXMvJHt0aGlzLl9pdGVtfS9pbWFnZT9pbWFnZVNsdWc9JHtpbWFnZVNsdWd9Jm5lc3RlZElEPSR7bmVzdGVkSUR9YDtcbiAgICAgIHRoaXMuaW5zdGFuY2UuYXhpb3NJbnN0YW5jZVxuICAgICAgICAucHV0KHVybCwgZm9ybSwgeyBoZWFkZXJzOiBmb3JtSGVhZGVycyB9KVxuICAgICAgICAudGhlbigoaW1nUmVzcG9uc2UpID0+IHtcbiAgICAgICAgICByZXNvbHZlKGltZ1Jlc3BvbnNlKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHJlamVjdChlcnIpKTtcbiAgICB9KTtcbiAgfVxuXG4gIGRlbGV0ZSgpIHtcbiAgICBjb25zdCBuZXN0ZWRJRCA9IHRoaXMubmVzdGVkQ29sbGVjdGlvbnNJRHMuam9pbihcIi5cIik7XG4gICAgbGV0IHVybCA9IGAke2Jhc2VFbmRwb2ludH0vY29sbGVjdGlvbi8ke3RoaXMuY29sbGVjdGlvbklEfS9pdGVtcy8ke3RoaXMuX2l0ZW19YDtcbiAgICBpZiAobmVzdGVkSUQpIHVybCA9IHVybCArIGA/bmVzdGVkSUQ9JHtuZXN0ZWRJRH1gO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICB0aGlzLmluc3RhbmNlLmF4aW9zSW5zdGFuY2VcbiAgICAgICAgLmRlbGV0ZSh1cmwpXG4gICAgICAgIC50aGVuKChyZXMpID0+IHJlc29sdmUocmVzKSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHJlamVjdChlcnIpKTtcbiAgICB9KTtcbiAgfVxuXG4gIHNldChkYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogQXhpb3NQcm9taXNlIHtcbiAgICBjb25zdCBuZXN0ZWRJRCA9IHRoaXMubmVzdGVkQ29sbGVjdGlvbnNJRHMuam9pbihcIi5cIik7XG4gICAgbGV0IHVybCA9IGAke2Jhc2VFbmRwb2ludH0vY29sbGVjdGlvbi8ke3RoaXMuY29sbGVjdGlvbklEfS9pdGVtcy8ke3RoaXMuX2l0ZW19P3NldD10cnVlYDtcbiAgICBpZiAobmVzdGVkSUQpIHVybCA9IHVybCArIGAmbmVzdGVkSUQ9JHtuZXN0ZWRJRH1gO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICB0aGlzLmluc3RhbmNlLmF4aW9zSW5zdGFuY2VcbiAgICAgICAgLnB1dCh1cmwsIEpTT04uc3RyaW5naWZ5KGRhdGEpKVxuICAgICAgICAudGhlbihhc3luYyAocmVzKSA9PiB7XG4gICAgICAgICAgcmVzb2x2ZShyZXMpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4gcmVqZWN0KGVycikpO1xuICAgIH0pO1xuICB9XG5cbiAgcHV0KGRhdGE6IFJlY29yZDxzdHJpbmcsIGFueT4pOiBBeGlvc1Byb21pc2Uge1xuICAgIGNvbnN0IG5lc3RlZElEID0gdGhpcy5uZXN0ZWRDb2xsZWN0aW9uc0lEcy5qb2luKFwiLlwiKTtcbiAgICBsZXQgdXJsID0gYCR7YmFzZUVuZHBvaW50fS9jb2xsZWN0aW9uLyR7dGhpcy5jb2xsZWN0aW9uSUR9L2l0ZW1zLyR7dGhpcy5faXRlbX1gO1xuICAgIGlmIChuZXN0ZWRJRCkgdXJsID0gdXJsICsgYD9uZXN0ZWRJRD0ke25lc3RlZElEfWA7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHRoaXMuaW5zdGFuY2UuYXhpb3NJbnN0YW5jZVxuICAgICAgICAucHV0KHVybCwgSlNPTi5zdHJpbmdpZnkoZGF0YSkpXG4gICAgICAgIC50aGVuKGFzeW5jIChyZXMpID0+IHtcbiAgICAgICAgICByZXNvbHZlKHJlcyk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiByZWplY3QoZXJyKSk7XG4gICAgfSk7XG4gIH1cblxuICBwb3N0KGRhdGE6IFJlY29yZDxzdHJpbmcsIGFueT4pOiBBeGlvc1Byb21pc2Uge1xuICAgIGNvbnN0IG5lc3RlZElEID0gdGhpcy5uZXN0ZWRDb2xsZWN0aW9uc0lEcy5qb2luKFwiLlwiKTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgbGV0IHVybCA9IGAke2Jhc2VFbmRwb2ludH0vY29sbGVjdGlvbi8ke3RoaXMuY29sbGVjdGlvbklEfS9pdGVtc2A7XG4gICAgICBpZiAobmVzdGVkSUQpIHVybCA9IHVybCArIGAvJHt0aGlzLl9pdGVtfT9uZXN0ZWRJRD0ke25lc3RlZElEfWA7XG4gICAgICB0aGlzLmluc3RhbmNlLmF4aW9zSW5zdGFuY2VcbiAgICAgICAgLnBvc3QodXJsLCBkYXRhKVxuICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgcmVzb2x2ZShyZXMpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBhcHBlbmQoZmllbGRTbHVnLCB2YWx1ZSk6IEF4aW9zUHJvbWlzZSB7XG4gICAgY29uc3QgbmVzdGVkSUQgPSB0aGlzLm5lc3RlZENvbGxlY3Rpb25zSURzLmpvaW4oXCIuXCIpO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBsZXQgdXJsID0gYCR7YmFzZUVuZHBvaW50fS9jb2xsZWN0aW9uLyR7dGhpcy5jb2xsZWN0aW9uSUR9L2l0ZW1zLyR7dGhpcy5faXRlbX0vZmllbGQvJHtmaWVsZFNsdWd9YDtcbiAgICAgIGlmIChuZXN0ZWRJRCkgdXJsID0gdXJsICsgYD9uZXN0ZWRJRD0ke25lc3RlZElEfWA7XG4gICAgICB0aGlzLmluc3RhbmNlLmF4aW9zSW5zdGFuY2VcbiAgICAgICAgLnB1dCh1cmwsIHsgdmFsdWU6IHZhbHVlIH0pXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICByZXNvbHZlKHJlcyk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGZpZWxkKGZpZWxkU2x1Zykge1xuICAgIGlmICghZmllbGRTbHVnIHx8IGZpZWxkU2x1Zy5tYXRjaCgvXFxzLykpIHRocm93IFwiZmllbGQgc2x1ZyBjYW50IGJlIFwiICsgZmllbGRTbHVnO1xuICAgIHRoaXMuX2ZpZWxkID0gZmllbGRTbHVnO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgaW5jcmVtZW50KGluY3JlbWVudFZhbHVlKTogQXhpb3NQcm9taXNlIHtcbiAgICBpZiAoIXRoaXMuX2ZpZWxkKSB0aHJvdyBcImZpZWxkIG11c3QgYmUgc2V0IHRvIHVzZSB0aGUgaW5jcmVtZW50IG1ldGhvZFwiO1xuICAgIGlmIChpc05hTihwYXJzZUZsb2F0KGluY3JlbWVudFZhbHVlKSkpIHRocm93IFwiSW5jcmVtZW50IHZhbHVlIG11c3QgYmUgYSBudW1iZXJcIjtcbiAgICBjb25zdCBuZXN0ZWRJRCA9IHRoaXMubmVzdGVkQ29sbGVjdGlvbnNJRHMuam9pbihcIi5cIik7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGxldCB1cmwgPSBgJHtiYXNlRW5kcG9pbnR9L2NvbGxlY3Rpb24vJHt0aGlzLmNvbGxlY3Rpb25JRH0vaXRlbXMvJHt0aGlzLl9pdGVtfS9maWVsZC8ke3RoaXMuX2ZpZWxkfT9pbmNyZW1lbnQ9JHtpbmNyZW1lbnRWYWx1ZX1gO1xuICAgICAgaWYgKG5lc3RlZElEKSB1cmwgPSB1cmwgKyBgJm5lc3RlZElEPSR7bmVzdGVkSUR9YDtcbiAgICAgIHRoaXMuaW5zdGFuY2UuYXhpb3NJbnN0YW5jZVxuICAgICAgICAucHV0KHVybClcbiAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgIHJlc29sdmUocmVzKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZGVjcmVtZW50KGRlY3JlbWVudFZhbHVlKTogQXhpb3NQcm9taXNlIHtcbiAgICBpZiAoIXRoaXMuX2ZpZWxkKSB0aHJvdyBcImZpZWxkIG11c3QgYmUgc2V0IHRvIHVzZSB0aGUgZGVjcmVtZW50IG1ldGhvZFwiO1xuICAgIGlmICh0eXBlb2YgZGVjcmVtZW50VmFsdWUgPT0gXCJzdHJpbmdcIikgZGVjcmVtZW50VmFsdWUgPSBwYXJzZUZsb2F0KGRlY3JlbWVudFZhbHVlKTtcbiAgICBpZiAoaXNOYU4oZGVjcmVtZW50VmFsdWUpKSB0aHJvdyBcIkluY3JlbWVudCB2YWx1ZSBtdXN0IGJlIGEgbnVtYmVyXCI7XG4gICAgaWYgKGRlY3JlbWVudFZhbHVlID4gMCkgZGVjcmVtZW50VmFsdWUgPSBkZWNyZW1lbnRWYWx1ZSAqIC0xO1xuICAgIGNvbnN0IG5lc3RlZElEID0gdGhpcy5uZXN0ZWRDb2xsZWN0aW9uc0lEcy5qb2luKFwiLlwiKTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgbGV0IHVybCA9IGAke2Jhc2VFbmRwb2ludH0vY29sbGVjdGlvbi8ke3RoaXMuY29sbGVjdGlvbklEfS9pdGVtcy8ke3RoaXMuX2l0ZW19L2ZpZWxkLyR7dGhpcy5fZmllbGR9P2luY3JlbWVudD0ke2RlY3JlbWVudFZhbHVlfWA7XG4gICAgICBpZiAobmVzdGVkSUQpIHVybCA9IHVybCArIGAmbmVzdGVkSUQ9JHtuZXN0ZWRJRH1gO1xuICAgICAgdGhpcy5pbnN0YW5jZS5heGlvc0luc3RhbmNlXG4gICAgICAgIC5wdXQodXJsKVxuICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgcmVzb2x2ZShyZXMpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICB1bnNldChmaWVsZFNsdWcsIHZhbHVlKTogQXhpb3NQcm9taXNlIHtcbiAgICBjb25zdCBuZXN0ZWRJRCA9IHRoaXMubmVzdGVkQ29sbGVjdGlvbnNJRHMuam9pbihcIi5cIik7XG4gICAgaWYgKG5lc3RlZElEKSB0aHJvdyBcIlVuc2V0IGlzIG5vdCB5ZXQgc3VwcG9ydGVkIGluIG5lc3RlZCBjb2xsZWN0aW9uc1wiO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBsZXQgdXJsID0gYCR7YmFzZUVuZHBvaW50fS9jb2xsZWN0aW9uLyR7dGhpcy5jb2xsZWN0aW9uSUR9L2l0ZW1zLyR7dGhpcy5faXRlbX0vZmllbGQvJHtmaWVsZFNsdWd9YDtcbiAgICAgIGlmIChuZXN0ZWRJRCkgdXJsID0gdXJsICsgYD9uZXN0ZWRJRD0ke25lc3RlZElEfWA7XG4gICAgICB0aGlzLmluc3RhbmNlLmF4aW9zSW5zdGFuY2VcbiAgICAgICAgLmRlbGV0ZSh1cmwsIHsgZGF0YTogeyB2YWx1ZTogdmFsdWUgfSB9KVxuICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgcmVzb2x2ZShyZXMpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICB2YWx1ZShmaWVsZFNsdWcsIHZhbHVlKTogQXhpb3NQcm9taXNlIHtcbiAgICBjb25zdCBuZXN0ZWRJRCA9IHRoaXMubmVzdGVkQ29sbGVjdGlvbnNJRHMuam9pbihcIi5cIik7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGxldCB1cmwgPSBgJHtiYXNlRW5kcG9pbnR9L2NvbGxlY3Rpb24vJHt0aGlzLmNvbGxlY3Rpb25JRH0vaXRlbXMvJHt0aGlzLl9pdGVtfS9maWVsZC8ke2ZpZWxkU2x1Z31gO1xuICAgICAgaWYgKG5lc3RlZElEKSB1cmwgPSB1cmwgKyBgP25lc3RlZElEPSR7bmVzdGVkSUR9YDtcbiAgICAgIHRoaXMuaW5zdGFuY2UuYXhpb3NJbnN0YW5jZVxuICAgICAgICAuZGVsZXRlKHVybCwgeyBkYXRhOiB7IHZhbHVlOiB2YWx1ZSB9IH0pXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICByZXNvbHZlKHJlcyk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldCgpOiBBeGlvc1Byb21pc2Uge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBjb25zdCBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XG4gICAgICBjb25zdCBuZXN0ZWRJRCA9IHRoaXMubmVzdGVkQ29sbGVjdGlvbnNJRHMuam9pbihcIi5cIik7XG4gICAgICB0aGlzLl9wYWdlTnVtYmVyICYmIHBhcmFtcy5hcHBlbmQoXCJwYWdlTnVtYmVyXCIsIFN0cmluZyh0aGlzLl9wYWdlTnVtYmVyKSk7XG4gICAgICB0aGlzLnNvcnRGaWVsZCAmJiBwYXJhbXMuYXBwZW5kKFwic29ydFwiLCB0aGlzLnNvcnRGaWVsZCk7XG4gICAgICB0aGlzLnNvcnRPcmRlciAmJiBwYXJhbXMuYXBwZW5kKFwib3JkZXJcIiwgdGhpcy5zb3J0T3JkZXIpO1xuICAgICAgdGhpcy5pdGVtc1BlclBhZ2UgJiYgcGFyYW1zLmFwcGVuZChcInBlclBhZ2VcIiwgU3RyaW5nKHRoaXMuaXRlbXNQZXJQYWdlKSk7XG4gICAgICB0aGlzLmNhbGxFdmVyeXRoaW5nICYmIHBhcmFtcy5hcHBlbmQoXCJldmVyeXRoaW5nXCIsIFN0cmluZyh0aGlzLmNhbGxFdmVyeXRoaW5nKSk7XG4gICAgICB0aGlzLl9wcm9qZWN0T2ZmICE9IFwiXCIgJiYgcGFyYW1zLmFwcGVuZChcInByb2plY3RPZmZcIiwgdGhpcy5fcHJvamVjdE9mZik7XG4gICAgICB0aGlzLl9wcm9qZWN0T24gIT0gXCJcIiAmJiBwYXJhbXMuYXBwZW5kKFwicHJvamVjdE9uXCIsIHRoaXMuX3Byb2plY3RPbik7XG5cbiAgICAgIGNvbnN0IGl0ZW1JRCA9IHRoaXMuX2l0ZW0gPyBcIi9cIiArIHRoaXMuX2l0ZW0gOiBcIlwiO1xuXG4gICAgICBsZXQgdXJsID0gYCR7YmFzZUVuZHBvaW50fS9jb2xsZWN0aW9uLyR7dGhpcy5jb2xsZWN0aW9uSUR9L2l0ZW1zJHtpdGVtSUR9PyR7cGFyYW1zLnRvU3RyaW5nKCl9YDtcbiAgICAgIGlmICh0aGlzLl9xdWVyeS5sZW5ndGggPiAwKSB1cmwgPSB1cmwgKyBcIiZxdWVyeT1cIiArIHRoaXMuX3F1ZXJ5LmpvaW4oXCIlMkJcIik7XG4gICAgICBpZiAobmVzdGVkSUQpIHVybCA9IHVybCArIGAmbmVzdGVkSUQ9JHtuZXN0ZWRJRH1gO1xuXG4gICAgICB0aGlzLmluc3RhbmNlLmF4aW9zSW5zdGFuY2VcbiAgICAgICAgLmdldCh1cmwpXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICBpZiAocmVzLnN0YXR1cyA+PSAyMDAgJiYgcmVzLnN0YXR1cyA8IDQwMCkge1xuICAgICAgICAgICAgcmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgdXNlcnMoKTogQXhpb3NQcm9taXNlIHtcbiAgICBpZiAoIXRoaXMuX2l0ZW0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlVzZXJzIGNhbiBvbmx5IGJlIHJldHJpZXZlZCBpbiByZWxhdGlvbiB0byBhbiBpdGVtXCIpO1xuICAgIH1cbiAgICBjb25zdCBuZXN0ZWRJRCA9IHRoaXMubmVzdGVkQ29sbGVjdGlvbnNJRHMuam9pbihcIi5cIik7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGxldCB1cmwgPSBgJHtiYXNlRW5kcG9pbnR9L2NvbGxlY3Rpb24vJHt0aGlzLmNvbGxlY3Rpb25JRH0vaXRlbXMvJHt0aGlzLl9pdGVtfS9iYWdlbFVzZXJzYDtcbiAgICAgIGlmIChuZXN0ZWRJRCkgdXJsID0gdXJsICsgYD9uZXN0ZWRJRD0ke25lc3RlZElEfWA7XG4gICAgICB0aGlzLmluc3RhbmNlLmF4aW9zSW5zdGFuY2VcbiAgICAgICAgLmdldCh1cmwpXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICByZXNvbHZlKHJlcyk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZFVzZXIoYmFnZWxVc2VySUQpOiBBeGlvc1Byb21pc2Uge1xuICAgIGlmICghdGhpcy5faXRlbSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVXNlcnMgY2FuIG9ubHkgYmUgYWRkZWQgaW4gcmVsYXRpb24gdG8gYW4gaXRlbVwiKTtcbiAgICB9XG4gICAgY29uc3QgbmVzdGVkSUQgPSB0aGlzLm5lc3RlZENvbGxlY3Rpb25zSURzLmpvaW4oXCIuXCIpO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBsZXQgdXJsID0gYCR7YmFzZUVuZHBvaW50fS9jb2xsZWN0aW9uLyR7dGhpcy5jb2xsZWN0aW9uSUR9L2l0ZW1zLyR7dGhpcy5faXRlbX0vYmFnZWxVc2Vyc2A7XG4gICAgICBpZiAobmVzdGVkSUQpIHVybCA9IHVybCArIGA/bmVzdGVkSUQ9JHtuZXN0ZWRJRH1gO1xuICAgICAgdGhpcy5pbnN0YW5jZS5heGlvc0luc3RhbmNlXG4gICAgICAgIC5wdXQodXJsLCB7IHVzZXJJRDogYmFnZWxVc2VySUQgfSlcbiAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgIHJlc29sdmUocmVzKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgcmVtb3ZlVXNlcihiYWdlbFVzZXJJRCk6IEF4aW9zUHJvbWlzZSB7XG4gICAgaWYgKCF0aGlzLl9pdGVtKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVc2VycyBjYW4gb25seSBiZSByZW1vdmVkIGluIHJlbGF0aW9uIHRvIGFuIGl0ZW1cIik7XG4gICAgfVxuICAgIGNvbnN0IG5lc3RlZElEID0gdGhpcy5uZXN0ZWRDb2xsZWN0aW9uc0lEcy5qb2luKFwiLlwiKTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgbGV0IHVybCA9IGAke2Jhc2VFbmRwb2ludH0vY29sbGVjdGlvbi8ke3RoaXMuY29sbGVjdGlvbklEfS9pdGVtcy8ke3RoaXMuX2l0ZW19L2JhZ2VsVXNlcnNgO1xuICAgICAgaWYgKG5lc3RlZElEKSB1cmwgPSB1cmwgKyBgP25lc3RlZElEPSR7bmVzdGVkSUR9YDtcbiAgICAgIHRoaXMuaW5zdGFuY2UuYXhpb3NJbnN0YW5jZVxuICAgICAgICAuZGVsZXRlKHVybCwgeyBkYXRhOiB7IHVzZXJJRDogYmFnZWxVc2VySUQgfSB9KVxuICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgcmVzb2x2ZShyZXMpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBDbGllbnQgaXMgcmV0dXJuZWQuIEl0IG11c3QgYmUgY2xvc2VkIHdoZW4gaXQgaXMgbm8gbG9uZ2VyIHJlcXVpcmVkIHVzaW5nIGNsaWVudC5jbG9zZSgpXG4gIC8vIG9ubWVzc2FnZSBhbmQgb25lcnJvciBhcmUgY2FsbGJhY2sgZnVuY3Rpb25zIHRvIHByb2Nlc3MgdGhlIGRhdGFcbiAgLy8gc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9FdmVudFNvdXJjZSBmb3IgbW9yZSBpbmZvIG9uIFNlcnZlciBTaWRlIEV2ZW50cyAoU1NFKVxuICBhc3luYyBsaXN0ZW4ob25tZXNzYWdlOiAoLi4uYXJnczogYW55KSA9PiB1bmtub3duLCBvbmVycm9yOiAoLi4uYXJnczogYW55KSA9PiB1bmtub3duKSB7XG4gICAgaWYgKCFvbm1lc3NhZ2UpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIm9uTWVzc2FnZSBjYWxsYmFjayBtdXN0IGJlIGRlZmluZWRcIik7XG4gICAgfVxuXG4gICAgbGV0IHRva2VuOiBzdHJpbmcgfCBudWxsIHwgQXhpb3NSZXNwb25zZTxzdHJpbmcsIGFueT47XG4gICAgaWYgKGF3YWl0IHRoaXMuaW5zdGFuY2UudXNlcnMoKS5fYmFnZWxVc2VyQWN0aXZlKCkpIHRva2VuID0gYXdhaXQgdGhpcy5pbnN0YW5jZS51c2VycygpLl9nZXRBY2Nlc3NUb2tlbigpO1xuICAgIGVsc2UgdG9rZW4gPSB0aGlzLmFwaVRva2VuO1xuXG4gICAgY29uc3QgbmVzdGVkSUQgPSB0aGlzLm5lc3RlZENvbGxlY3Rpb25zSURzLmpvaW4oXCIuXCIpO1xuXG4gICAgY29uc3QgdXJsID1cbiAgICAgIGxpdmVFbmRwb2ludCArXG4gICAgICBgL2NvbGxlY3Rpb24vJHt0aGlzLmNvbGxlY3Rpb25JRH0vbGl2ZT9hdXRob3JpemF0aW9uPSR7dG9rZW59Jm5lc3RlZElEPSR7bmVzdGVkSUR9Jml0ZW1JRD0ke3RoaXMuX2l0ZW19YDtcbiAgICB0aGlzLmNsaWVudCA9IG5ldyBFdmVudFNvdXJjZSh1cmwpO1xuICAgIGNvbnN0IHRoYXQgPSB0aGlzO1xuXG4gICAgY29uc3QgZXJyb3JIYW5kbGVyID0gYXN5bmMgKGV2ZW50KSA9PiB7XG4gICAgICBpZiAodGhhdC5jbGllbnQucmVhZHlTdGF0ZSA9PT0gRXZlbnRTb3VyY2UuQ0xPU0VEKSB7XG4gICAgICAgIGlmIChhd2FpdCB0aGF0Lmluc3RhbmNlLnVzZXJzKCkuX2JhZ2VsVXNlckFjdGl2ZSgpKSB7XG4gICAgICAgICAgYXdhaXQgdGhhdC5pbnN0YW5jZS51c2VycygpLnJlZnJlc2goKTtcbiAgICAgICAgICB0b2tlbiA9IGF3YWl0IHRoYXQuaW5zdGFuY2UudXNlcnMoKS5fZ2V0QWNjZXNzVG9rZW4oKTtcbiAgICAgICAgICBjb25zdCB1cmwgPVxuICAgICAgICAgICAgbGl2ZUVuZHBvaW50ICtcbiAgICAgICAgICAgIGAvY29sbGVjdGlvbi8ke3RoYXQuY29sbGVjdGlvbklEfS9saXZlP2F1dGhvcml6YXRpb249JHt0b2tlbn0mcmVxdWVzdElEPSR7dGhhdC5yZXF1ZXN0SUR9Jm5lc3RlZElEPSR7bmVzdGVkSUR9Jml0ZW1JRD0ke3RoYXQuX2l0ZW19YDtcbiAgICAgICAgICB0aGF0LmNsaWVudCA9IG5ldyBFdmVudFNvdXJjZSh1cmwpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKG9uZXJyb3IpIHtcbiAgICAgICAgb25lcnJvcihldmVudCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMuY2xpZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdGFydFwiLCBmdW5jdGlvbiAoZTogRXZlbnQgJiBSZWNvcmQ8c3RyaW5nLCBhbnk+KSB7XG4gICAgICB0aGF0LnJlcXVlc3RJRCA9IGUuZGF0YTtcbiAgICB9KTtcblxuICAgIHRoaXMuY2xpZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdG9wXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGlmIChhd2FpdCB0aGF0Lmluc3RhbmNlLnVzZXJzKCkuX2JhZ2VsVXNlckFjdGl2ZSgpKSB0b2tlbiA9IGF3YWl0IHRoYXQuaW5zdGFuY2UudXNlcnMoKS5fZ2V0QWNjZXNzVG9rZW4oKTtcbiAgICAgIGVsc2UgdG9rZW4gPSB0aGF0LmFwaVRva2VuO1xuXG4gICAgICB0aGF0LmNsaWVudC5jbG9zZSgpO1xuICAgICAgY29uc3QgdXJsID1cbiAgICAgICAgbGl2ZUVuZHBvaW50ICtcbiAgICAgICAgYC9jb2xsZWN0aW9uLyR7dGhhdC5jb2xsZWN0aW9uSUR9L2xpdmU/YXV0aG9yaXphdGlvbj0ke3Rva2VufSZyZXF1ZXN0SUQ9JHt0aGF0LnJlcXVlc3RJRH0mbmVzdGVkSUQ9JHtuZXN0ZWRJRH0maXRlbUlEPSR7dGhhdC5faXRlbX1gO1xuICAgICAgdGhhdC5jbGllbnQgPSBuZXcgRXZlbnRTb3VyY2UodXJsKTtcbiAgICAgIHRoYXQuY2xpZW50Lm9ubWVzc2FnZSA9IG9ubWVzc2FnZTtcbiAgICAgIHRoYXQuY2xpZW50Lm9uZXJyb3IgPSBlcnJvckhhbmRsZXI7XG4gICAgfSk7XG5cbiAgICB0aGlzLmNsaWVudC5vbm1lc3NhZ2UgPSBvbm1lc3NhZ2U7XG4gICAgdGhpcy5jbGllbnQub25lcnJvciA9IGVycm9ySGFuZGxlcjtcbiAgICByZXR1cm4gdGhpcy5jbGllbnQ7XG4gIH1cbn1cbiIsImltcG9ydCB7IEF4aW9zUHJvbWlzZSB9IGZyb20gXCJheGlvc1wiO1xuaW1wb3J0IHsgYmFzZUVuZHBvaW50IH0gZnJvbSBcIi4vY29tbW9uXCI7XG5pbXBvcnQgeyBCYWdlbERCUmVxdWVzdCB9IGZyb20gXCIuL2NvbW1vblwiO1xuaW1wb3J0IHsgc3RydWN0QXJncyB9IGZyb20gXCIuL2ludGVyZmFjZXNcIjtcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJhZ2VsTWV0YVJlcXVlc3QgZXh0ZW5kcyBCYWdlbERCUmVxdWVzdCB7XG4gIGNvbnN0cnVjdG9yKHsgaW5zdGFuY2UsIGNvbGxlY3Rpb25JRCB9OiBzdHJ1Y3RBcmdzKSB7XG4gICAgc3VwZXIoeyBpbnN0YW5jZSwgY29sbGVjdGlvbklEIH0pO1xuICB9XG5cbiAgZ2V0KCk6IEF4aW9zUHJvbWlzZSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGNvbnN0IHVybCA9IGAke2Jhc2VFbmRwb2ludH0vY29sbGVjdGlvbi8ke3RoaXMuY29sbGVjdGlvbklEfS9zY2hlbWFgO1xuICAgICAgdGhpcy5pbnN0YW5jZS5heGlvc0luc3RhbmNlXG4gICAgICAgIC5nZXQodXJsKVxuICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPj0gMjAwICYmIHJlcy5zdGF0dXMgPCA0MDApIHtcbiAgICAgICAgICAgIHJlc29sdmUocmVzKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVqZWN0KHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxufVxuIiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IHJlcXVpcmUoXCJsb2Rhc2gtZXNcIik7IiwiXG5pbXBvcnQgeyBBeGlvc0luc3RhbmNlLCBBeGlvc1Byb21pc2UgfSBmcm9tIFwiLi9jb21tb25cIjtcbmltcG9ydCB7IGJhZ2VsVHlwZSwgQmFnZWxVc2VyIH0gZnJvbSBcIi4vaW50ZXJmYWNlc1wiO1xuaW1wb3J0IEZhbGxiYWNrU3RvcmFnZSAgZnJvbSAnLi9mYlN0b3JhZ2UnO1xuXG5cbmNvbnN0IEFVVEhfRU5EUE9JTlQgPSBcImh0dHBzOi8vYXV0aC5iYWdlbGRiLmNvbS9hcGkvcHVibGljXCI7XG5cbmlmICghZ2xvYmFsVGhpcz8ubG9jYWxTdG9yYWdlKSB7XG4gIGdsb2JhbFRoaXMubG9jYWxTdG9yYWdlID0gbmV3IEZhbGxiYWNrU3RvcmFnZSh7fSk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJhZ2VsVXNlcnNSZXF1ZXN0IHtcbiAgaW5zdGFuY2U6IGJhZ2VsVHlwZTtcbiAgYXhpb3M6IEF4aW9zSW5zdGFuY2U7XG4gIGJhZ2VsU3RvcmFnZTogU3RvcmFnZTtcbiAgW3g6IHN0cmluZ106IGFueTtcblxuICBjb25zdHJ1Y3Rvcih7IGluc3RhbmNlIH06IHsgaW5zdGFuY2U6IGJhZ2VsVHlwZX0pIHtcbiAgICB0aGlzLmluc3RhbmNlID0gaW5zdGFuY2U7XG4gICAgdGhpcy5heGlvcyA9IHRoaXMuaW5zdGFuY2UuYXhpb3NJbnN0YW5jZTtcbiAgICB0aGlzLmJhZ2VsU3RvcmFnZSA9IHRoaXMuaW5zdGFuY2U/LmN1c3RvbVN0b3JhZ2UgfHwgZ2xvYmFsVGhpcz8ubG9jYWxTdG9yYWdlO1xuICB9XG5cbiAgX2lzQnJvd3NlcigpOiBib29sZWFuIHtcbiAgICBjb25zdCBpc05vZGUgPSBuZXcgRnVuY3Rpb24oXG4gICAgICBcInRyeSB7cmV0dXJuIHRoaXM9PT1nbG9iYWw7fWNhdGNoKGUpe3JldHVybiBmYWxzZTt9XCJcbiAgICAgICk7XG5cbiAgICAgIHJldHVybiAhaXNOb2RlKCk7XG4gIH1cblxuICBhc3luYyBfYmFnZWxVc2VyQWN0aXZlKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IGlzQnJvd3NlciA9ICB0aGlzLl9pc0Jyb3dzZXIoKTtcbiAgIGNvbnN0IGJhZ2VsVXNlcklEID0gYXdhaXQgdGhpcy5nZXRCYWdlbFVzZXJJRCgpO1xuICAgIHJldHVybiAoXG4gICAgICBpc0Jyb3dzZXIgJiYgYmFnZWxVc2VySUQgIT09IG51bGwgJiYgYmFnZWxVc2VySUQubGVuZ3RoID4gMFxuICAgICk7XG4gIH1cblxuICBjcmVhdGUoZW1haWw6IHN0cmluZywgcGFzc3dvcmQ6IHN0cmluZyk6IEF4aW9zUHJvbWlzZTxhbnk+IHtcbiAgICBlbWFpbCA9IGVtYWlsLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBjb25zdCB1cmwgPSBgJHtBVVRIX0VORFBPSU5UfS91c2VyYDtcbiAgICAgIGNvbnN0IGJvZHkgPSB7IGVtYWlsLCBwYXNzd29yZCB9O1xuICAgICAgdGhpcy5heGlvc1xuICAgICAgICAucG9zdCh1cmwsIGJvZHkpXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PSAyMDEpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgZGF0YSB9ID0gcmVzO1xuICAgICAgICAgICAgaWYgKHRoaXMuaW5zdGFuY2UuaXNTZXJ2ZXIpIHtcbiAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhLnVzZXJfaWQpO1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9zdG9yZVRva2VucyhkYXRhKTtcbiAgICAgICAgICAgIHRoaXMuX3N0b3JlQmFnZWxVc2VyKGRhdGEudXNlcl9pZCk7XG4gICAgICAgICAgICByZXNvbHZlKGRhdGEudXNlcl9pZCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdChyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvLy8gVmFsaWRhdGUgdGhlIHVzZXIncyByZWNlaXZlZCBPbmUgVGltZSBQYXNzd29yZFxuICBhc3luYyB2YWxpZGF0ZU90cChvdHA6IFJlY29yZDxzdHJpbmcsIGFueT4pIHtcbiAgICBjb25zdCBub25jZSA9IGF3YWl0IHRoaXMuX2dldE90cFJlcXVlc3ROb25jZSgpO1xuICAgIGNvbnN0IHVybCA9IGAke0FVVEhfRU5EUE9JTlR9L3VzZXIvb3RwL3ZlcmlmeS8ke25vbmNlfWA7XG4gICAgY29uc3QgYm9keSA9IHsgb3RwIH07XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuYXhpb3MucG9zdCh1cmwsIGJvZHkpO1xuICAgICAgdGhpcy5fc3RvcmVUb2tlbnMocmVzLmRhdGEpO1xuICAgICAgcmV0dXJuIHJlcy5kYXRhW1widXNlcl9pZFwiXTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHRocm93IFwid3JvbmcgYXV0aG9yaXphdGlvbiBjb2RlXCI7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgX2dldE90cFJlcXVlc3ROb25jZSgpIHtcbiAgICBjb25zdCBvdHBSZXF1ZXN0ID0gYXdhaXQgdGhpcy5iYWdlbFN0b3JhZ2UuZ2V0SXRlbShcImJhZ2VsLW5vbmNlXCIpO1xuICAgIGNvbnN0IGV4cGlyZXMgPSArKGF3YWl0IHRoaXMuYmFnZWxTdG9yYWdlLmdldEl0ZW0oXCJiYWdlbC1leHBpcmVzXCIpIHx8IFwiXCIpO1xuICAgIGlmIChvdHBSZXF1ZXN0ICYmIGV4cGlyZXMpIHtcbiAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgaWYgKGV4cGlyZXMgPD0gZGF0ZS5zZXRTZWNvbmRzKGRhdGUuZ2V0U2Vjb25kcygpKSlcbiAgICAgICAgdGhyb3cgXCJPVFAgcmVxdWVzdCBoYXMgZXhwaXJlZCwgdHJ5IGFnYWluXCI7XG4gICAgICByZXR1cm4gb3RwUmVxdWVzdDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgXCJSZXF1ZXN0IGFuIE9UUCBmaXJzdFwiO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJlcXVlc3RPdHAoZW1haWxPclBob25lOiBzdHJpbmcpIHtcbiAgICBlbWFpbE9yUGhvbmUgPSBlbWFpbE9yUGhvbmUudG9Mb3dlckNhc2UoKS50cmltKCk7XG4gICAgY29uc3QgdXJsID0gYCR7QVVUSF9FTkRQT0lOVH0vdXNlci9vdHBgO1xuICAgIGNvbnN0IGJvZHkgPSB7IGVtYWlsT3JQaG9uZTogZW1haWxPclBob25lIH07XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuYXhpb3MucG9zdCh1cmwsIGJvZHkpO1xuICAgICAgYXdhaXQgdGhpcy5fc3RvcmVPdHBSZXF1ZXN0Tm9uY2UocmVzLmRhdGEpO1xuICAgICAgcmV0dXJuIHJlcy5kYXRhW1wibm9uY2VcIl07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiBlcnJvcjtcbiAgICB9XG4gIH1cblxuICBhc3luYyBfc3RvcmVPdHBSZXF1ZXN0Tm9uY2Uoe1xuICAgIG5vbmNlLFxuICAgIGV4cGlyZXNfaW4sXG4gIH06IHtcbiAgICBub25jZTogc3RyaW5nO1xuICAgIGV4cGlyZXNfaW46IG51bWJlcjtcbiAgfSkge1xuICAgIGNvbnN0IGV4cGlyZXMgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IHN0b3JlZEV4cGlyZSA9IGAke2V4cGlyZXMuc2V0U2Vjb25kcyhcbiAgICAgIGV4cGlyZXMuZ2V0U2Vjb25kcygpICsgZXhwaXJlc19pblxuICAgICl9YDtcbiAgIGF3YWl0IHRoaXMuYmFnZWxTdG9yYWdlLnNldEl0ZW0oXCJiYWdlbC1ub25jZVwiLCBub25jZSk7XG4gICBhd2FpdCB0aGlzLmJhZ2VsU3RvcmFnZS5zZXRJdGVtKFwiYmFnZWwtZXhwaXJlc1wiLCBzdG9yZWRFeHBpcmUpO1xuICB9XG5cbiAgdmFsaWRhdGUoZW1haWw6IHN0cmluZywgcGFzc3dvcmQ6IHN0cmluZyk6IEF4aW9zUHJvbWlzZTxhbnk+IHtcbiAgICBlbWFpbCA9IGVtYWlsLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBjb25zdCB1cmwgPSBgJHtBVVRIX0VORFBPSU5UfS91c2VyL3ZlcmlmeWA7XG4gICAgICBjb25zdCBib2R5ID0geyBlbWFpbCwgcGFzc3dvcmQgfTtcbiAgICAgIHRoaXMuYXhpb3NcbiAgICAgICAgLnBvc3QodXJsLCBib2R5KVxuICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT0gMjAwKSB7XG4gICAgICAgICAgICBjb25zdCB7IGRhdGEgfSA9IHJlcztcbiAgICAgICAgICAgIHRoaXMuX3N0b3JlVG9rZW5zKGRhdGEpO1xuICAgICAgICAgICAgdGhpcy5fc3RvcmVCYWdlbFVzZXIoZGF0YS51c2VyX2lkKTtcbiAgICAgICAgICAgIHJlc29sdmUoZGF0YS51c2VyX2lkKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVqZWN0KHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldFVzZXIoKTogQXhpb3NQcm9taXNlPEJhZ2VsVXNlcj4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBpZiAoIXRoaXMuX2JhZ2VsVXNlckFjdGl2ZSgpKSB7XG4gICAgICAgIHJlamVjdChcbiAgICAgICAgICBuZXcgRXJyb3IoXCJhIEJhZ2VsIFVzZXIgbXVzdCBiZSBsb2dnZWQgaW4gdG8gZ2V0IEJhZ2VsIFVzZXIgaW5mb1wiK3RoaXMuX2JhZ2VsVXNlckFjdGl2ZSgpKVxuICAgICAgICApO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCB1cmwgPSBgJHtBVVRIX0VORFBPSU5UfS91c2VyYDtcbiAgICAgIHRoaXMuYXhpb3NcbiAgICAgICAgLmdldCh1cmwpXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PSAyMDApIHtcbiAgICAgICAgICAgIHJlc29sdmUocmVzKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVqZWN0KHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlcXVlc3RQYXNzd29yZFJlc2V0KGVtYWlsOiBzdHJpbmcpOiBBeGlvc1Byb21pc2U8dW5rbm93bj4ge1xuICAgIGVtYWlsID0gZW1haWwudG9Mb3dlckNhc2UoKS50cmltKCk7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGNvbnN0IHVybCA9IGAke0FVVEhfRU5EUE9JTlR9L3VzZXIvcmVzZXRwYXNzd29yZGA7XG4gICAgICBjb25zdCBib2R5ID0geyBlbWFpbCB9O1xuICAgICAgdGhpcy5heGlvc1xuICAgICAgICAucG9zdCh1cmwsIGJvZHkpXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PSAyMDApIHtcbiAgICAgICAgICAgIHJlc29sdmUocmVzKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVqZWN0KHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHVwZGF0ZVBhc3N3b3JkKGVtYWlsOiBzdHJpbmcsIHVwZGF0ZWRQYXNzd29yZDogc3RyaW5nKTogQXhpb3NQcm9taXNlPHVua25vd24+IHtcbiAgICBlbWFpbCA9IGVtYWlsLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBpZiAodGhpcy5faXNCcm93c2VyKCkpIHtcbiAgICAgICAgcmVqZWN0KFxuICAgICAgICAgIG5ldyBFcnJvcihcbiAgICAgICAgICAgIFwiVXBkYXRlIFBhc3N3b3JkIGZlYXR1cmUgaXMgb25seSBhdmFpbGFibGUgd2hlbiB1c2luZyBOb2RlSlNcIlxuICAgICAgICAgIClcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3QgdXJsID0gYCR7QVVUSF9FTkRQT0lOVH0vdXNlci91cGRhdGVQYXNzd29yZGA7XG4gICAgICBjb25zdCBib2R5ID0geyBlbWFpbDogZW1haWwsIHBhc3N3b3JkOiB1cGRhdGVkUGFzc3dvcmQgfTtcbiAgICAgIHRoaXMuYXhpb3NcbiAgICAgICAgLnBvc3QodXJsLCBib2R5KVxuICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT0gMjAwKSB7XG4gICAgICAgICAgICByZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdChyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBfc3RvcmVCYWdlbFVzZXIodXNlcklEOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgIGF3YWl0IHRoaXMuYmFnZWxTdG9yYWdlLnNldEl0ZW0oXCJiYWdlbC11c2VyXCIsIHVzZXJJRCk7XG4gIH1cblxuICBhc3luYyBfc3RvcmVUb2tlbnMoZGF0YTogUmVjb3JkPHN0cmluZywgYW55Pik6IFByb21pc2U8dm9pZD4ge1xuICAgYXdhaXQgdGhpcy5iYWdlbFN0b3JhZ2Uuc2V0SXRlbShcImJhZ2VsLWFjY2Vzc1wiLCBkYXRhLmFjY2Vzc190b2tlbik7XG4gICAgY29uc3QgZXhwaXJlczogYW55ID0gbmV3IERhdGUoKTtcbiAgICBleHBpcmVzLnNldFNlY29uZHMoZXhwaXJlcy5nZXRTZWNvbmRzKCkgKyBkYXRhLmV4cGlyZXNfaW4pO1xuICAgYXdhaXQgdGhpcy5iYWdlbFN0b3JhZ2Uuc2V0SXRlbShcImJhZ2VsLWV4cGlyZXNcIiwgZXhwaXJlcyk7XG4gICBhd2FpdCB0aGlzLmJhZ2VsU3RvcmFnZS5zZXRJdGVtKFwiYmFnZWwtcmVmcmVzaFwiLCBkYXRhLnJlZnJlc2hfdG9rZW4pO1xuICB9XG5cbiAgYXN5bmMgZ2V0QmFnZWxVc2VySUQoKXtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5iYWdlbFN0b3JhZ2UuZ2V0SXRlbShcImJhZ2VsLXVzZXJcIikgYXMgc3RyaW5nO1xuICB9XG5cbiAgYXN5bmMgX2dldFJlZnJlc2hUb2tlbigpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5iYWdlbFN0b3JhZ2UuZ2V0SXRlbShcImJhZ2VsLXJlZnJlc2hcIik7XG4gIH1cblxuICBhc3luYyBfZ2V0QWNjZXNzVG9rZW4oKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsIHwgQXhpb3NQcm9taXNlPHN0cmluZz4+IHtcbiAgICBjb25zdCBlID0gYXdhaXQgdGhpcy5iYWdlbFN0b3JhZ2UuZ2V0SXRlbShcImJhZ2VsLWV4cGlyZXNcIikgfHwgXCJcIjtcbiAgICBjb25zdCBleHBpcmVzID0gbmV3IERhdGUoZSk7XG4gICAgaWYgKGV4cGlyZXMgPD0gbmV3IERhdGUoKSkgcmV0dXJuIHRoaXMucmVmcmVzaCgpO1xuICAgIGVsc2UgcmV0dXJuIGF3YWl0IHRoaXMuYmFnZWxTdG9yYWdlLmdldEl0ZW0oXCJiYWdlbC1hY2Nlc3NcIik7XG4gIH1cblxuICBhc3luYyBsb2dvdXQoKTogUHJvbWlzZTx2b2lkPiB7XG4gICBhd2FpdCB0aGlzLmJhZ2VsU3RvcmFnZS5yZW1vdmVJdGVtKFwiYmFnZWwtdXNlclwiKTtcbiAgIGF3YWl0IHRoaXMuYmFnZWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJiYWdlbC1hY2Nlc3NcIik7XG4gICBhd2FpdCB0aGlzLmJhZ2VsU3RvcmFnZS5yZW1vdmVJdGVtKFwiYmFnZWwtcmVmcmVzaFwiKTtcbiAgfVxuXG4gIHJlZnJlc2goKTogQXhpb3NQcm9taXNlPHN0cmluZz4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBpZiAoIXRoaXMuX2dldFJlZnJlc2hUb2tlbigpKSB7XG4gICAgICAgIHJlamVjdChuZXcgRXJyb3IoXCJObyBCYWdlbCBVc2VyIGlzIGxvZ2dlZCBpblwiKSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVybCA9IGAke0FVVEhfRU5EUE9JTlR9L3VzZXIvdG9rZW5gO1xuICAgICAgY29uc3QgYm9keSA9IGBncmFudF90eXBlPXJlZnJlc2hfdG9rZW4mcmVmcmVzaF90b2tlbj0ke3RoaXMuX2dldFJlZnJlc2hUb2tlbigpfSZjbGllbnRfaWQ9cHJvamVjdC1jbGllbnRgO1xuICAgICAgdGhpcy5heGlvc1xuICAgICAgICAucG9zdCh1cmwsIGJvZHkpXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgICBjb25zdCB7IGRhdGEgfSA9IHJlcztcbiAgICAgICAgICAgIHRoaXMuX3N0b3JlVG9rZW5zKGRhdGEpO1xuICAgICAgICAgICAgcmVzb2x2ZShkYXRhLmFjY2Vzc190b2tlbik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdChyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsIiBpbXBvcnQge2lzVW5kZWZpbmVkLCB3aXRob3V0LCBrZXlzLCBzaXplLCBpbmNsdWRlc30gZnJvbSAnbG9kYXNoLWVzJztcblxuIGV4cG9ydCBkZWZhdWx0IGNsYXNzIEZhbGxiYWNrU3RvcmFnZSB7XG4gICAga2V5OiAoaW5kZXg6IGFueSkgPT4gYW55XG4gICAgc2V0SXRlbTogKGtleTogYW55LCB2YWx1ZTogYW55KSA9PiB2b2lkXG4gICAgZ2V0SXRlbTogKGtleTogYW55KSA9PiBhbnlcbiAgICByZW1vdmVJdGVtOiAoa2V5OiBhbnkpID0+IHZvaWRcbiAgICBjbGVhcjogKCkgPT4gdm9pZFxuICAgIGxlbmd0aDogbnVtYmVyXG4gICAgX19wcm90ZWN0ZWQ6ICgpID0+IHsgZGF0YTogYW55OyB9XG5cbiBjb25zdHJ1Y3RvciAoZGF0YSkge1xuXG4gICAgIGxldCBzdG9yYWdlID0gdGhpcztcblxuICAgICBpZiAoIWRhdGEpIGRhdGEgPSB7fTtcblxuICAgICBsZXQga2V5bGlzdCA9IGtleXMoZGF0YSk7XG5cbiAgICAgbGV0IG51bGxPclZhbHVlID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICByZXR1cm4gaXNVbmRlZmluZWQodmFsdWUpID8gbnVsbCA6IHZhbHVlO1xuICAgICB9O1xuXG4gICAgIHRoaXMua2V5ID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgIGxldCBrZXkgPSBrZXlsaXN0W2luZGV4XTtcbiAgICAgICAgIHJldHVybiBudWxsT3JWYWx1ZShrZXkpO1xuICAgICB9O1xuXG4gICAgIHRoaXMuc2V0SXRlbSA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICAgICAgIGlmICghaW5jbHVkZXMoa2V5bGlzdCwga2V5KSkga2V5bGlzdC5wdXNoKGtleSk7XG4gICAgICAgICBkYXRhWyBrZXkgXSA9IHZhbHVlO1xuICAgICAgICAgc3RvcmFnZS5sZW5ndGggPSBzaXplKCBkYXRhICk7XG4gICAgIH07XG5cbiAgICAgdGhpcy5nZXRJdGVtID0gZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgICBsZXQgdmFsdWUgPSBkYXRhWyBrZXkgXTtcbiAgICAgICAgIHJldHVybiBudWxsT3JWYWx1ZSh2YWx1ZSk7XG4gICAgIH07XG5cbiAgICAgdGhpcy5yZW1vdmVJdGVtID0gZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgZGVsZXRlIGRhdGEgWyBrZXkgXTtcbiAgICAgICBrZXlsaXN0ID0gd2l0aG91dCgga2V5bGlzdCwga2V5ICk7XG4gICAgICAgc3RvcmFnZS5sZW5ndGggPSBzaXplKCBkYXRhICk7XG4gICAgIH07XG5cbiAgICAgdGhpcy5jbGVhciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgbGV0IF9rZXlzID0ga2V5cyggZGF0YSApO1xuICAgICAgICAgbGV0IHJlbW92ZSA9IHRoaXMucmVtb3ZlSXRlbTtcbiAgICAgICAgIF9rZXlzLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgICAgICAgcmVtb3ZlKGtleSk7XG4gICAgICAgICB9KTtcbiAgICAgfTtcblxuICAgICB0aGlzLmxlbmd0aCA9IHNpemUoIGRhdGEgKTtcblxuICAgICB0aGlzLl9fcHJvdGVjdGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgIGRhdGFcbiAgICAgICAgIH07XG4gICAgIH07XG5cbiAgICB9XG4gfTtcblxuXG4iLCJpbXBvcnQgYXhpb3MsIHsgQXhpb3NJbnN0YW5jZSwgQXhpb3NQcm9taXNlIH0gZnJvbSBcImF4aW9zXCI7XG5pbXBvcnQgQmFnZWxEQlJlcXVlc3QgZnJvbSBcIi4vYmFnZWxEQlJlcXVlc3RcIjtcbmltcG9ydCBCYWdlbE1ldGFSZXF1ZXN0IGZyb20gXCIuL2JhZ2VsTWV0YVJlcXVlc3RcIjtcbmltcG9ydCBCYWdlbFVzZXJzUmVxdWVzdCBmcm9tIFwiLi91c2Vyc1wiO1xuXG5jb25zdCBiYXNlRW5kcG9pbnQgPSBcImh0dHBzOi8vYXBpLmJhZ2Vsc3R1ZGlvLmNvL2FwaS9wdWJsaWNcIjtcbmNvbnN0IGxpdmVFbmRwb2ludCA9IFwiaHR0cHM6Ly9saXZlLmJhZ2VsZGIuY29tL2FwaS9wdWJsaWNcIjtcblxuZXhwb3J0IHtcbiAgQmFnZWxVc2Vyc1JlcXVlc3QsXG4gIEJhZ2VsREJSZXF1ZXN0LFxuICBCYWdlbE1ldGFSZXF1ZXN0LFxufTtcbmV4cG9ydCB7XG4gIEF4aW9zSW5zdGFuY2UsXG4gIGF4aW9zLFxuICBiYXNlRW5kcG9pbnQsXG4gIGxpdmVFbmRwb2ludCxcbiAgQXhpb3NQcm9taXNlXG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiZm9ybS1kYXRhXCIpOyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInRzbGliXCIpOyIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gKG1vZHVsZSkgPT4ge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHQoKSA9PiAobW9kdWxlWydkZWZhdWx0J10pIDpcblx0XHQoKSA9PiAobW9kdWxlKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCJpbXBvcnQgeyBBeGlvc0luc3RhbmNlLCBBeGlvc1JlcXVlc3RIZWFkZXJzIH0gZnJvbSBcImF4aW9zXCI7XG5pbXBvcnQge1xuICBCYWdlbERCUmVxdWVzdCxcbiAgQmFnZWxNZXRhUmVxdWVzdCxcbiAgQmFnZWxVc2Vyc1JlcXVlc3QsXG4gIGF4aW9zLFxufSBmcm9tIFwiLi9jb21tb25cIjtcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJhZ2VsIHtcbiAgW3g6IHN0cmluZ106IGFueTtcbiAgaXNTZXJ2ZXI6IGJvb2xlYW47XG4gIGN1c3RvbVN0b3JhZ2U6ICBTdG9yYWdlIHwgdW5kZWZpbmVkO1xuICBhcGlUb2tlbjogc3RyaW5nO1xuICBheGlvc0luc3RhbmNlOiBBeGlvc0luc3RhbmNlO1xuICBjb25zdHJ1Y3RvcihhcGlUb2tlbjogc3RyaW5nLCBvcHRpb25zOiB7aXNTZXJ2ZXI/OiBib29sZWFuOyBjdXN0b21TdG9yYWdlPzogU3RvcmFnZSB8IHVuZGVmaW5lZDsgfSA9IHsgaXNTZXJ2ZXI6IGZhbHNlLCBjdXN0b21TdG9yYWdlOiB1bmRlZmluZWQgfSkge1xuICAgIHRoaXMuaXNTZXJ2ZXIgPSAhIW9wdGlvbnMuaXNTZXJ2ZXI7XG4gICAgdGhpcy5jdXN0b21TdG9yYWdlID0gb3B0aW9ucy5jdXN0b21TdG9yYWdlO1xuICAgIHRoaXMuYXBpVG9rZW4gPSBhcGlUb2tlbjtcbiAgICB0aGlzLmF4aW9zSW5zdGFuY2UgPSBheGlvcy5jcmVhdGUoKTtcbiAgICB0aGlzLmF4aW9zSW5zdGFuY2UuaW50ZXJjZXB0b3JzLnJlcXVlc3QudXNlKFxuICAgICAgYXN5bmMgKGNvbmZpZykgPT4ge1xuICAgICAgICAoY29uZmlnLmhlYWRlcnMgYXMgQXhpb3NSZXF1ZXN0SGVhZGVycylbXCJBY2NlcHQtVmVyc2lvblwiXSA9IFwidjFcIjtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIGF3YWl0IG5ldyBCYWdlbFVzZXJzUmVxdWVzdCh7IGluc3RhbmNlOiB0aGlzIH0pLl9iYWdlbFVzZXJBY3RpdmUoKSAmJlxuICAgICAgICAgICFjb25maWcudXJsPy5pbmNsdWRlcyhcInVzZXIvdG9rZW5cIilcbiAgICAgICAgKSB7XG4gICAgICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBuZXcgQmFnZWxVc2Vyc1JlcXVlc3Qoe1xuICAgICAgICAgICAgaW5zdGFuY2U6IHRoaXMsXG4gICAgICAgICAgfSkuX2dldEFjY2Vzc1Rva2VuKCk7XG4gICAgICAgICAgKGNvbmZpZy5oZWFkZXJzIGFzIEF4aW9zUmVxdWVzdEhlYWRlcnMpLkF1dGhvcml6YXRpb24gPSBcIkJlYXJlciBcIiArIGFjY2Vzc1Rva2VuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIChjb25maWcuaGVhZGVycyBhcyBBeGlvc1JlcXVlc3RIZWFkZXJzKS5BdXRob3JpemF0aW9uID0gXCJCZWFyZXIgXCIgKyBhcGlUb2tlbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAgfSxcbiAgICAgIChlcnJvcikgPT4ge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICAgICAgfVxuICAgICk7XG5cbiAgICB0aGlzLmF4aW9zSW5zdGFuY2UuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLnVzZShcbiAgICAgIChyZXNwb25zZSkgPT4ge1xuICAgICAgICByZXR1cm4gcmVzcG9uc2U7XG4gICAgICB9LFxuICAgICAgYXN5bmMgKGVycm9yKSA9PiB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICBhd2FpdCBuZXcgQmFnZWxVc2Vyc1JlcXVlc3QoeyBpbnN0YW5jZTogdGhpcyB9KS5fYmFnZWxVc2VyQWN0aXZlKCkgJiZcbiAgICAgICAgICBlcnJvci5yZXNwb25zZSAmJlxuICAgICAgICAgIGVycm9yLnJlc3BvbnNlLnN0YXR1cyA9PSA0MDEgJiZcbiAgICAgICAgICAhZXJyb3IuY29uZmlnLnVybC5pbmNsdWRlcyhcInVzZXIvdG9rZW5cIilcbiAgICAgICAgKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBCYWdlbFVzZXJzUmVxdWVzdCh7IGluc3RhbmNlOiB0aGlzIH0pXG4gICAgICAgICAgICAucmVmcmVzaCgpXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IGVycm9yLmNvbmZpZztcbiAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnNbXCJBdXRob3JpemF0aW9uXCJdID0gYEJlYXJlciAke25ldyBCYWdlbFVzZXJzUmVxdWVzdChcbiAgICAgICAgICAgICAgICB7IGluc3RhbmNlOiB0aGlzIH1cbiAgICAgICAgICAgICAgKS5fZ2V0QWNjZXNzVG9rZW4oKX1gO1xuICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICAgIGF4aW9zXG4gICAgICAgICAgICAgICAgICAucmVxdWVzdChjb25maWcpXG4gICAgICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoKSA9PiB7XG4gICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICAgICAgfVxuICAgICk7XG4gIH1cblxuICBzY2hlbWEoY29sbGVjdGlvbklEOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gbmV3IEJhZ2VsTWV0YVJlcXVlc3QoeyBpbnN0YW5jZTogdGhpcywgY29sbGVjdGlvbklEIH0pO1xuICB9XG5cbiAgY29sbGVjdGlvbihjb2xsZWN0aW9uSUQ6IHN0cmluZykge1xuICAgIHJldHVybiBuZXcgQmFnZWxEQlJlcXVlc3QoeyBpbnN0YW5jZTogdGhpcywgY29sbGVjdGlvbklEIH0pO1xuICB9XG5cbiAgdXNlcnMoKSB7XG4gICAgcmV0dXJuIG5ldyBCYWdlbFVzZXJzUmVxdWVzdCh7IGluc3RhbmNlOiB0aGlzIH0pO1xuICB9XG5cbiAgc3RhdGljIGdldCBBU0MoKSB7XG4gICAgcmV0dXJuIFwiQVNDXCI7XG4gIH1cblxuICBzdGF0aWMgZ2V0IERFU0MoKSB7XG4gICAgcmV0dXJuIFwiREVTQ1wiO1xuICB9XG5cbiAgc3RhdGljIGdldCBFUVVBTCgpIHtcbiAgICByZXR1cm4gXCI9XCI7XG4gIH1cblxuICBzdGF0aWMgZ2V0IE5PVF9FUVVBTCgpIHtcbiAgICByZXR1cm4gXCIhPVwiO1xuICB9XG5cbiAgc3RhdGljIGdldCBHUkVBVEVSX1RIQU4oKSB7XG4gICAgcmV0dXJuIFwiPlwiO1xuICB9XG5cbiAgc3RhdGljIGdldCBMRVNTX1RIQU4oKSB7XG4gICAgcmV0dXJuIFwiPFwiO1xuICB9XG5cbiAgc3RhdGljIGdldCBXSVRISU4oKSB7XG4gICAgcmV0dXJuIFwid2l0aGluXCI7XG4gIH1cblxuICBzdGF0aWMgR2VvUG9pbnRRdWVyeShsYXQ6IG51bWJlciwgbG5nOiBudW1iZXIsIGRpc3RhbmNlOiBudW1iZXIpIHtcbiAgICByZXR1cm4gYCR7bGF0fSwke2xuZ30sJHtkaXN0YW5jZX1gO1xuICB9XG59XG4iXSwibmFtZXMiOlsicmVxdWlyZSIsImluc3RhbmNlIiwiY29sbGVjdGlvbklEIiwidGhpcyIsIl9wYWdlTnVtYmVyIiwiaXRlbXNQZXJQYWdlIiwiY2FsbEV2ZXJ5dGhpbmciLCJfcXVlcnkiLCJuZXN0ZWRDb2xsZWN0aW9uc0lEcyIsImF4aW9zSW5zdGFuY2UiLCJhcGlUb2tlbiIsIl9wcm9qZWN0T24iLCJfcHJvamVjdE9mZiIsInJlcXVlc3RJRCIsInNvcnRGaWVsZCIsInNvcnRPcmRlciIsIl9pdGVtIiwiX2ZpZWxkIiwicGFnZU51bWJlciIsInBlclBhZ2UiLCJjb2xsZWN0aW9uU2x1ZyIsInB1c2giLCJfaWQiLCJsZW5ndGgiLCJrZXkiLCJvcGVyYXRvciIsInZhbHVlIiwiQXJyYXkiLCJpc0FycmF5Iiwiam9pbiIsInF1ZXJ5IiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiZmllbGQiLCJvcmRlciIsInNsdWdzIiwiaW1hZ2VTbHVnIiwiZm9ybSIsInNlbGVjdGVkSW1hZ2UiLCJpbWFnZUxpbmsiLCJhbHRUZXh0IiwiZmlsZU5hbWUiLCJpc05vZGUiLCJGdW5jdGlvbiIsIkZvcm1EYXRhIiwiZm9ybUhlYWRlcnMiLCJuZXN0ZWRJRCIsImFwcGVuZCIsImdldEhlYWRlcnMiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsInVybCIsImJhc2VFbmRwb2ludCIsInB1dCIsImhlYWRlcnMiLCJ0aGVuIiwiaW1nUmVzcG9uc2UiLCJjYXRjaCIsImVyciIsImRlbGV0ZSIsInJlcyIsImRhdGEiLCJKU09OIiwic3RyaW5naWZ5IiwicG9zdCIsImVycm9yIiwiZmllbGRTbHVnIiwibWF0Y2giLCJpbmNyZW1lbnRWYWx1ZSIsImlzTmFOIiwicGFyc2VGbG9hdCIsImRlY3JlbWVudFZhbHVlIiwicGFyYW1zIiwiVVJMU2VhcmNoUGFyYW1zIiwiU3RyaW5nIiwiaXRlbUlEIiwidG9TdHJpbmciLCJnZXQiLCJzdGF0dXMiLCJFcnJvciIsImJhZ2VsVXNlcklEIiwidXNlcklEIiwib25tZXNzYWdlIiwib25lcnJvciIsInVzZXJzIiwiX2JhZ2VsVXNlckFjdGl2ZSIsIl9nZXRBY2Nlc3NUb2tlbiIsInRva2VuIiwibGl2ZUVuZHBvaW50IiwiY2xpZW50IiwiRXZlbnRTb3VyY2UiLCJ0aGF0IiwiZXJyb3JIYW5kbGVyIiwiZXZlbnQiLCJyZWFkeVN0YXRlIiwiQ0xPU0VEIiwicmVmcmVzaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiY2xvc2UiLCJBVVRIX0VORFBPSU5UIiwiZ2xvYmFsVGhpcyIsImxvY2FsU3RvcmFnZSIsInN0b3JhZ2UiLCJrZXlsaXN0Iiwia2V5cyIsIm51bGxPclZhbHVlIiwiaXNVbmRlZmluZWQiLCJpbmRleCIsInNldEl0ZW0iLCJpbmNsdWRlcyIsInNpemUiLCJnZXRJdGVtIiwicmVtb3ZlSXRlbSIsIndpdGhvdXQiLCJjbGVhciIsIl9rZXlzIiwicmVtb3ZlIiwiZm9yRWFjaCIsIl9fcHJvdGVjdGVkIiwiYXhpb3MiLCJiYWdlbFN0b3JhZ2UiLCJjdXN0b21TdG9yYWdlIiwiaXNCcm93c2VyIiwiX2lzQnJvd3NlciIsImdldEJhZ2VsVXNlcklEIiwiZW1haWwiLCJwYXNzd29yZCIsInRvTG93ZXJDYXNlIiwidHJpbSIsImJvZHkiLCJpc1NlcnZlciIsInVzZXJfaWQiLCJfc3RvcmVUb2tlbnMiLCJfc3RvcmVCYWdlbFVzZXIiLCJvdHAiLCJfZ2V0T3RwUmVxdWVzdE5vbmNlIiwibm9uY2UiLCJvdHBSZXF1ZXN0IiwiZXhwaXJlcyIsImRhdGUiLCJEYXRlIiwic2V0U2Vjb25kcyIsImdldFNlY29uZHMiLCJlbWFpbE9yUGhvbmUiLCJfc3RvcmVPdHBSZXF1ZXN0Tm9uY2UiLCJleHBpcmVzX2luIiwic3RvcmVkRXhwaXJlIiwidXBkYXRlZFBhc3N3b3JkIiwiYWNjZXNzX3Rva2VuIiwicmVmcmVzaF90b2tlbiIsIl9nZXRSZWZyZXNoVG9rZW4iLCJtb2R1bGUiLCJleHBvcnRzIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsIm4iLCJnZXR0ZXIiLCJfX2VzTW9kdWxlIiwiZCIsImEiLCJkZWZpbml0aW9uIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJvcHRpb25zIiwiaW50ZXJjZXB0b3JzIiwicmVxdWVzdCIsInVzZSIsImNvbmZpZyIsImFjY2Vzc1Rva2VuIiwiQXV0aG9yaXphdGlvbiIsInJlc3BvbnNlIiwibGF0IiwibG5nIiwiZGlzdGFuY2UiXSwic291cmNlUm9vdCI6IiJ9